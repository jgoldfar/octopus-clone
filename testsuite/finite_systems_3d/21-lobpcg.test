# -*- coding: utf-8 -*-
# $Id$

Test       : LOBPCG
Program    : octopus
TestGroups : short-run, finite_systems_3d
Enabled    : Yes

# Depending on the context, the LOBPCG routine takes different branches, which
# are checked with this test:
#   * spin-polarized.
#   * spinors

Input: 21-lobpcg.01-spin_polarized.inp
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ; -146.74150377; 0.0001
match ; Ion-ion energy     ; GREPFIELD(static/info, 'Ion-ion     =', 3) ; 0.00000000; 0.0001
match ; Eigenvalues sum    ; GREPFIELD(static/info, 'Eigenvalues =', 3) ; -38.58624314; 0.0001
match ; Hartree energy     ; GREPFIELD(static/info, 'Hartree     =', 3) ; 120.23139030; 0.0001
match ; Int[n*v_xc]        ; GREPFIELD(static/info, 'Int\[n\*v_xc\] =', 3) ; -51.09852505; 0.0001
match ; Exchange energy    ; GREPFIELD(static/info, 'Exchange    =', 3) ; -34.26008614; 0.0001
match ; Correlation energy ; GREPFIELD(static/info, 'Correlation =', 3) ; -4.76230915; 0.0001
match ; Kinetic energy     ; GREPFIELD(static/info, 'Kinetic     =', 3) ; 88.52863377; 0.0001
match ; External energy    ; GREPFIELD(static/info, 'External    =', 3) ; -316.47911276; 0.0001

match ; Eigenvalue 1 up; GREPFIELD(static/info, ' 1   up', 3) ; -14.461727; 0.0001
match ; Eigenvalue 1 dn; GREPFIELD(static/info, ' 1   dn', 3) ; -11.750136; 0.0001
match ; Eigenvalue 2 up; GREPFIELD(static/info, ' 2   up', 3) ; -6.187145; 0.0001
match ; Eigenvalue 2 dn; GREPFIELD(static/info, ' 2   dn', 3) ; -3.682145; 0.0001
match ; Eigenvalue 3 up; GREPFIELD(static/info, ' 3   up', 3) ; -6.187145; 0.0001
match ; Eigenvalue 3 dn; GREPFIELD(static/info, ' 3   dn', 3) ; -3.682145; 0.0001
match ; Eigenvalue 4 up; GREPFIELD(static/info, ' 4   up', 3) ; -6.187145; 0.0001
match ; Eigenvalue 4 dn; GREPFIELD(static/info, ' 4   dn', 3) ; -3.682145; 0.0001

match ; mz             ; GREPFIELD(static/info, 'Local Magnetic Moments', 3, 2) ; 2.00000; 0.0001

Input: 21-lobpcg.02-spinors.inp
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ; -141.78882842; 0.00011
match ; Ion-ion energy     ; GREPFIELD(static/info, 'Ion-ion     =', 3) ; 0.00000000; 0.00011
match ; Eigenvalues sum    ; GREPFIELD(static/info, 'Eigenvalues =', 3) ; -43.94163200; 0.00011
match ; Hartree energy     ; GREPFIELD(static/info, 'Hartree     =', 3) ; 108.74106965; 0.00011
match ; Int[n*v_xc]        ; GREPFIELD(static/info, 'Int\[n\*v_xc\] =', 3) ; -46.22913931; 0.00011
match ; Exchange energy    ; GREPFIELD(static/info, 'Exchange    =', 3) ; -30.77251312; 0.00011
match ; Correlation energy ; GREPFIELD(static/info, 'Correlation =', 3) ; -4.56275297; 0.00011
match ; Kinetic energy     ; GREPFIELD(static/info, 'Kinetic     =', 3) ; 61.84478448; 0.00011
match ; External energy    ; GREPFIELD(static/info, 'External    =', 3) ; -277.03941862; 0.00011

match ; Eigenvalue 1  ; GREPFIELD(static/info, ' 1   --', 3) ; -18.502391; 0.001
match ; Eigenvalue 2  ; GREPFIELD(static/info, ' 2   --', 3) ; -16.446975; 0.001
match ; Eigenvalue 3  ; GREPFIELD(static/info, ' 3   --', 3) ; -4.496133; 0.001
match ; Eigenvalue 4  ; GREPFIELD(static/info, ' 4   --', 3) ; -4.496133; 0.001
match ; Eigenvalue 5  ; GREPFIELD(static/info, ' 5   --', 3) ; -4.496133; 0.001
match ; <Sx> 1        ; GREPFIELD(static/info, '1   --', 5) ; 0.3000; 0.001
match ; <Sy> 1        ; GREPFIELD(static/info, '1   --', 6) ; 0.3000; 0.001
match ; <Sz> 1        ; GREPFIELD(static/info, '1   --', 7) ; -0.2645; 0.001
match ; <Sx> 5        ; GREPFIELD(static/info, '5   --', 5) ; 0.3000; 0.001
match ; <Sy> 5        ; GREPFIELD(static/info, '5   --', 6) ; 0.3000; 0.001
match ; <Sz> 5        ; GREPFIELD(static/info, '5   --', 7) ; -0.2645; 0.001

match ; mx             ; GREPFIELD(static/info, 'Local Magnetic Moments', 3, 2) ; 1.200124; 0.005
match ; my             ; GREPFIELD(static/info, 'Local Magnetic Moments', 4, 2) ; 1.200124; 0.005
match ; mz             ; GREPFIELD(static/info, 'Local Magnetic Moments', 5, 2) ; -1.058020; 0.005
# This differs significantly from the initial magnetization.
# It is due to the small radius and large spacing.
