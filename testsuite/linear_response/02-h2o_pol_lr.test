# -*- coding: utf-8 mode: shell-script -*-
# $Id$

Test       : Linear-Response Polarizabilities
Program    : octopus
TestGroups : short-run, linear_response
Enabled    : Yes

Input: 02-h2o_pol_lr.01_h2o_gs.inp
match ; Total energy ; GREPFIELD(static/info, 'Total       =', 3) ; -16.06685186; 0.0001
match ; Eigenvalues  ; GREPFIELD(static/info, '1   --', 3) ; -1.167612; 0.0001
match ; Dipole       ; GREPFIELD(static/info, '<y>', 3) ; 3.65917E-01; 0.0001

Input: 02-h2o_pol_lr.02_h2o_dyn_pol.inp
match ; Polarizability XX w=0.0    ; LINEFIELD(em_resp/freq_0.0000/alpha, 2, 1) ; 15.248041; 0.0001
match ; Polarizability YY w=0.0    ; LINEFIELD(em_resp/freq_0.0000/alpha, 3, 2) ; 12.333210; 0.0001
match ; Polarizability ZZ w=0.0    ; LINEFIELD(em_resp/freq_0.0000/alpha, 4, 3) ; 23.149122; 0.0001

match ; Polarizability XX w=0.1    ; LINEFIELD(em_resp/freq_0.1000/alpha, 2, 1) ; 15.943344; 0.0001
match ; Polarizability YY w=0.1    ; LINEFIELD(em_resp/freq_0.1000/alpha, 3, 2) ; 12.856808; 0.0001
match ; Polarizability ZZ w=0.1    ; LINEFIELD(em_resp/freq_0.1000/alpha, 4, 3) ; 29.766976; 0.0001

match ; Born charge O  XX w=0.0    ; LINEFIELD(em_resp/freq_0.0000/Born_charges, 3, 1) ; -0.151322; 0.0001
match ; Born charge O  YY w=0.0    ; LINEFIELD(em_resp/freq_0.0000/Born_charges, 4, 2) ; -0.349310; 0.0001
match ; Born charge O  ZZ w=0.0    ; LINEFIELD(em_resp/freq_0.0000/Born_charges, 5, 3) ; -0.032368; 0.0001
match ; Born charge diff  w=0.0    ; GREPFIELD(em_resp/freq_0.0000/Born_charges, "Discrepancy",  3,  4) ;  0.008769; 0.0001

match ; Born charge O  XX w=0.1    ; LINEFIELD(em_resp/freq_0.1000/Born_charges, 3, 1) ; -0.196726; 0.0001
match ; Born charge O  YY w=0.1    ; LINEFIELD(em_resp/freq_0.1000/Born_charges, 4, 2) ; -0.408311; 0.0001
match ; Born charge O  ZZ w=0.1    ; LINEFIELD(em_resp/freq_0.1000/Born_charges, 5, 3) ; 0.145284; 0.0001
match ; Born charge diff  w=0.0    ; GREPFIELD(em_resp/freq_0.1000/Born_charges, "Discrepancy",  3,  4) ; -0.057861; 0.0001

Input: 02-h2o_pol_lr.03_h2o_dyn_pol_cmplx.inp
match ; Polarizability XX w=0.0    ; LINEFIELD(em_resp/freq_0.0000/alpha, 2, 1) ; 15.241500; 0.001
match ; Polarizability YY w=0.0    ; LINEFIELD(em_resp/freq_0.0000/alpha, 3, 2) ; 12.328310; 0.001
match ; Polarizability ZZ w=0.0    ; LINEFIELD(em_resp/freq_0.0000/alpha, 4, 3) ; 23.105771; 0.001

match ; Polarizability XX w=0.1    ; LINEFIELD(em_resp/freq_0.1000/alpha, 2, 1) ; 15.933969; 0.001
match ; Polarizability YY w=0.1    ; LINEFIELD(em_resp/freq_0.1000/alpha, 3, 2) ; 12.849790; 0.001
match ; Polarizability ZZ w=0.1    ; LINEFIELD(em_resp/freq_0.1000/alpha, 4, 3) ; 29.441098; 0.001

match ; Cross sect. (avg) w=0.1    ; LINEFIELD(em_resp/freq_0.1000/cross_section, -1, 2) ; 0.68980239E-02; 0.001
match ; Cross sect. (ani) w=0.1    ; LINEFIELD(em_resp/freq_0.1000/cross_section, -1, 3) ; 0.13986866E-01; 0.001

match ; Born charge O  XX w=0.0    ; LINEFIELD(em_resp/freq_0.0000/Born_charges, 5, 1) ; -0.150899; 0.001
match ; Born charge O  YY w=0.0    ; LINEFIELD(em_resp/freq_0.0000/Born_charges, 6, 2) ; -0.348757; 0.001
match ; Born charge O  ZZ w=0.0    ; LINEFIELD(em_resp/freq_0.0000/Born_charges, 7, 3) ; -0.033190; 0.001
match ; Born charge diff  w=0.0    ; GREPFIELD(em_resp/freq_0.0000/Born_charges, "Discrepancy",  3,  5) ;  0.009350; 0.001

match ; Born charge O  XX w=0.1    ; LINEFIELD(em_resp/freq_0.1000/Born_charges, 5, 1) ; -0.196159; 0.001
match ; Born charge O  YY w=0.1    ; LINEFIELD(em_resp/freq_0.1000/Born_charges, 6, 2) ; -0.407578; 0.001
match ; Born charge O  ZZ w=0.1    ; LINEFIELD(em_resp/freq_0.1000/Born_charges, 7, 3) ; 0.132121; 0.001
match ; Born charge diff  w=0.1    ; GREPFIELD(em_resp/freq_0.1000/Born_charges, "Discrepancy",  3,  5) ; -0.056346; 0.001

match ; Born charge O  XX w=-0.2   ; LINEFIELD(em_resp/freq_-0.2000/Born_charges, 5, 1) ; -0.366367; 0.001
match ; Born charge O  YY w=-0.2   ; LINEFIELD(em_resp/freq_-0.2000/Born_charges, 6, 2) ; -0.625975; 0.001
match ; Born charge O  ZZ w=-0.2   ; LINEFIELD(em_resp/freq_-0.2000/Born_charges, 7, 3) ; -1.699907; 0.001
match ; Born charge diff  w=-0.2   ; GREPFIELD(em_resp/freq_-0.2000/Born_charges, "Discrepancy", 3,  5) ; -0.155682; 0.001

match ; Hyperpolarizability w=0.0    ; GREPFIELD(em_resp/freq_0.0000/beta, 'beta // y', 4) ; -0.23080418E+02; 0.02
match ; Hyperpolarizability w=0.1 Re ; GREPFIELD(em_resp/freq_0.1000/beta, 'beta // y', 4) ; 0.86792097E+02; 0.02
match ; Hyperpolarizability w=0.1 Im ; GREPFIELD(em_resp/freq_0.1000/beta, 'beta // y', 5) ; -0.44353707E+00; 0.02

Input: 02-h2o_pol_lr.04_h2o_susc.inp
match; Paramagnetic susceptibility ; LINEFIELD(em_resp/freq_0.0000/susceptibility, 5, 3) ; 30.003216; 0.001
match; Diamagnetic susceptibility  ; LINEFIELD(em_resp/freq_0.0000/susceptibility, 11, 3) ; -215.363250; 0.001
match; Total susceptibility        ; LINEFIELD(em_resp/freq_0.0000/susceptibility, 17, 3) ; -185.360035; 0.001
